package test.beast.evolution.substmodel;

import java.io.FileOutputStream;
import java.io.PrintStream;
import java.lang.reflect.Constructor;
import java.util.Arrays;

import junit.framework.TestCase;
import beast.core.Description;
import beast.core.Input;
import beast.core.parameter.RealParameter;
import beast.evolution.substitutionmodel.DefaultEigenSystem;
import beast.evolution.substitutionmodel.EigenDecomposition;
import beast.evolution.substitutionmodel.EigenSystem;
import beast.evolution.substitutionmodel.Frequencies;
import beast.evolution.substitutionmodel.YN98;

@Description("Test YN98 matrix exponentiation")
public class YN98Test extends TestCase{
	
    /*
     * Results obtained by running the following scilab code,
     *
     * k = 5 ; piQ = diag([.2, .3, .25, .25]) ; d = 0.1 ;
     * % Q matrix with zeroed diagonal
     * XQ = [0 1 k 1; 1 0 1 k; k 1 0 1; 1 k 1 0];
     *
     * xx = XQ * piQ ;
     *
     * % fill diagonal and normalize by total substitution rate
     * q0 = (xx + diag(-sum(xx,2))) / sum(piQ * sum(xx,2)) ;
     * expm(q0 * d)
     */
	
	/*
	public void testYN98() throws Exception {
        RealParameter f = new RealParameter(new Double[]{0.2140365728337246,0.29317049897596853,0.10983236706946545,0.38296056112084154});
        Frequencies nucleoFrequencies = new Frequencies();
        nucleoFrequencies.initByName("frequencies", f, "estimate", false);

        YN98 yn98 = new YN98();
        yn98.initByName("kappa", "2.368504291751431", "omega", "1.0", "nucleoFrequencies", nucleoFrequencies);
        
        double distance = 0.1;
        
        double[] mat = new double[61 * 61];
        
        System.setOut(new PrintStream(new FileOutputStream("/home/kuangyu/Desktop/YN98_checkExp_distance01.txt")));
        yn98.getTransitionProbabilities(null, distance, 0, 1, mat);
        System.out.println(Arrays.toString(mat));
	}
	*/
	
    /**
     * create an EigenSystem of the class indicated by the eigenSystemClass input *
     */
    protected EigenSystem createEigenSystem() throws Exception {
        Input<String> eigenSystemClass = new Input<String>("eigenSystem", "Name of the class used for creating an EigenSystem", DefaultEigenSystem.class.getName());
        Constructor<?>[] ctors = Class.forName(eigenSystemClass.get()).getDeclaredConstructors();
        Constructor<?> ctor = null;
        for (int i = 0; i < ctors.length; i++) {
            ctor = ctors[i];
            if (ctor.getGenericParameterTypes().length == 1)
                break;
        }
        ctor.setAccessible(true);
        return (EigenSystem) ctor.newInstance(61);
    }
	
    
	public void testYN98_exp() throws Exception {
        RealParameter f = new RealParameter(new Double[]{0.2140365728337246,0.29317049897596853,0.10983236706946545,0.38296056112084154});
        Frequencies nucleoFrequencies = new Frequencies();
        nucleoFrequencies.initByName("frequencies", f, "estimate", false);

        YN98 yn98 = new YN98();
        yn98.initByName("kappa", "2.368504291751431", "omega", "1.0", "nucleoFrequencies", nucleoFrequencies);
        
        yn98.prepareMatricesForTest();
        double[][] rateM = yn98.getRateMatrix();
        
        System.setOut(new PrintStream(new FileOutputStream("/home/kuangyu/Desktop/YN98_checkExp_directCal_01.txt")));
        System.out.println("rateM:" + Arrays.deepToString(rateM));
        
        double[] matrix = new double[61 * 61];
        
        EigenSystem eigenSystem = createEigenSystem();
        EigenDecomposition eigenDecomposition = eigenSystem.decomposeMatrix(rateM);
        
        double distance = 0.1;
        int nrOfStates = 61;
        int i, j, k;
        double temp;
        
        double[] iexp = new double[nrOfStates * nrOfStates];
        // Eigen vectors
        double[] Evec = eigenDecomposition.getEigenVectors();
        System.out.println("Evec:" + Arrays.toString(Evec));
        // inverse Eigen vectors
        double[] Ievc = eigenDecomposition.getInverseEigenVectors();
        System.out.println("Ivec:" + Arrays.toString(Ievc));
        // Eigen values
        double[] Eval = eigenDecomposition.getEigenValues();
        System.out.println("Eval:" + Arrays.toString(Eval));
        
        for (i = 0; i < nrOfStates; i++) {
            temp = Math.exp(distance * Eval[i]);
            for (j = 0; j < nrOfStates; j++) {
                iexp[i * nrOfStates + j] = Ievc[i * nrOfStates + j] * temp;
            }
        }
        System.out.println("iexp:" + Arrays.toString(iexp));

        int u = 0;
        for (i = 0; i < nrOfStates; i++) {
            for (j = 0; j < nrOfStates; j++) {
                temp = 0.0;
                for (k = 0; k < nrOfStates; k++) {
                    temp += Evec[i * nrOfStates + k] * iexp[k * nrOfStates + j];
                }

                matrix[u] = Math.abs(temp);
                u++;
            }
        }
        //double distance = 0.1;
        
        //double[] mat = new double[61 * 61];
        
        //yn98.getTransitionProbabilities(null, distance, 0, 1, mat);
        System.out.println("probabilities:" + Arrays.toString(matrix));
	}
	
	
	public void testYN98_fixedRateM()  throws Exception {
		double[][] rateMatrix = new double[][]{ 
				{-0.79607,0.096207,0.085367,0.12567,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0.070238,-1.0184,0.036043,0.29766,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0},
				{0.16636,0.096207,-0.87706,0.12567,0,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0.070238,0.22787,0.036043,-0.94864,0,0,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0},
				{0.070238,0,0,0,-1.0184,0.096207,0.085367,0.12567,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0},
				{0,0.070238,0,0,0.070238,-1.1151,0.036043,0.29766,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0,0},
				{0,0,0.070238,0,0.16636,0.096207,-1.0994,0.12567,0,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0},
				{0,0,0,0.070238,0.070238,0.22787,0.036043,-1.0453,0,0,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0,0},
				{0.16636,0,0,0,0.096207,0,0,0,-0.87706,0.096207,0.085367,0.12567,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0.16636,0,0,0,0.096207,0,0,0.070238,-1.0994,0.036043,0.29766,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0},
				{0,0,0.16636,0,0,0,0.096207,0,0.16636,0.096207,-1.0837,0.12567,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0},
				{0,0,0,0.16636,0,0,0,0.096207,0.070238,0.22787,0.036043,-1.0296,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0,0},
				{0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0,0,-0.94864,0.096207,0.085367,0.12567,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0,0},
				{0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0,0.070238,-1.0453,0.036043,0.29766,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0,0},
				{0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0.16636,0.096207,-1.0296,0.12567,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0.12567,0},
				{0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0.070238,0.22787,0.036043,-0.97554,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.085367,0,0,0,0,0,0,0,0,0,0,0,0,0.12567},
				{0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.72077,0.096207,0.085367,0.12567,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,-1.1151,0.036043,0.29766,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0.16636,0.096207,-0.80177,0.12567,0,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0.22787,0.036043,-1.0453,0,0,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,-1.1151,0.096207,0.085367,0.12567,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0.070238,-1.2118,0.036043,0.29766,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0.16636,0.096207,-1.1961,0.12567,0,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0.070238,0.070238,0.22787,0.036043,-1.142,0,0,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0,0,0,-0.80177,0.096207,0.085367,0.12567,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0,0,0.070238,-1.1961,0.036043,0.29766,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0,0.16636,0.096207,-1.1804,0.12567,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0.070238,0.22787,0.036043,-1.1263,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0,0,-1.0453,0.096207,0.085367,0.12567,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0,0.070238,-1.142,0.036043,0.29766,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0.16636,0.096207,-1.1263,0.12567,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.29766,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0.070238,0.22787,0.036043,-1.0722,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.29766},
				{0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.87706,0.096207,0.085367,0.12567,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,-1.0994,0.036043,0.29766,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0,0.16636,0.096207,-0.95805,0.12567,0,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0.22787,0.036043,-1.0296,0,0,0,0.096207,0,0,0,0.085367,0,0,0,0.12567,0,0.12567,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,-1.0994,0.096207,0.085367,0.12567,0.036043,0,0,0,0.29766,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0.070238,-1.1961,0.036043,0.29766,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0.16636,0.096207,-1.1804,0.12567,0,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0.12567,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0,0,0,0,0.070238,0.070238,0.22787,0.036043,-1.1263,0,0,0,0.036043,0,0,0,0.29766,0,0,0,0,0,0.12567,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0,0,0,-0.95805,0.096207,0.085367,0.12567,0.12567,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0,0,0.070238,-1.1804,0.036043,0.29766,0,0.12567,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0,0.16636,0.096207,-1.1647,0.12567,0,0,0.12567,0,0,0,0,0,0,0,0,0.12567,0,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0,0,0,0,0.16636,0,0,0,0.096207,0.070238,0.22787,0.036043,-1.1106,0,0,0,0.12567,0,0,0,0,0,0,0,0,0.12567,0,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0,0,-1.0296,0.096207,0.085367,0.12567,0,0,0,0,0,0,0,0,0,0.12567,0,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0,0.070238,-1.1263,0.036043,0.29766,0,0,0,0,0,0,0,0,0,0,0.12567,0,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0,0.16636,0.096207,-1.1106,0.12567,0,0,0,0,0,0,0,0,0,0,0,0.12567,0},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.16636,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.096207,0,0,0,0.070238,0,0,0,0.22787,0,0,0,0.036043,0.070238,0.22787,0.036043,-1.0565,0,0,0,0,0,0,0,0,0,0,0,0,0.12567},
				{0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.93905,0.29766,0,0.096207,0,0,0.085367,0,0,0,0.12567,0,0},
				{0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,-0.86926,0,0,0,0.096207,0,0,0.085367,0,0,0,0.12567},
				{0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0,0,-0.93905,0.096207,0.085367,0.12567,0,0,0,0.29766,0,0,0},
				{0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0.070238,0,0.070238,-1.142,0.036043,0.29766,0.036043,0,0,0,0.29766,0,0},
				{0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0,0,0.16636,0.096207,-1.0561,0.12567,0,0.036043,0,0,0,0.29766,0},
				{0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0.070238,0.070238,0.22787,0.036043,-1.0722,0,0,0.036043,0,0,0,0.29766},
				{0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0.16636,0,0,0.096207,0,0,-1.0561,0.036043,0.29766,0,0.12567,0,0},
				{0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0,0,0,0,0.096207,0,0.096207,-0.77791,0.12567,0,0,0.12567,0},
				{0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0.16636,0,0,0,0.096207,0.22787,0.036043,-0.9863,0,0,0,0.12567},
				{0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0.22787,0,0,0,0,0,0,-0.86926,0.096207,0.085367,0.12567},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0.070238,0,0,0.22787,0,0,0.036043,0,0,0.070238,-1.0722,0.036043,0.29766},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0,0,0,0,0.22787,0,0,0.036043,0,0.16636,0.096207,-0.9863,0.12567},
				{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.070238,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.22787,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036043,0,0.070238,0,0,0,0.22787,0,0,0.036043,0.070238,0.22787,0.036043,-1.0024}
		};
		
        System.setOut(new PrintStream(new FileOutputStream("/home/kuangyu/Desktop/YN98_checkExp_directCal_02.txt")));
        System.out.println("rateM:" + Arrays.deepToString(rateMatrix));
        
        double[] matrix = new double[61 * 61];
        
        EigenSystem eigenSystem = createEigenSystem();
        EigenDecomposition eigenDecomposition = eigenSystem.decomposeMatrix(rateMatrix);
        
        double distance = 0.1;
        int nrOfStates = 61;
        int i, j, k;
        double temp;
        
        double[] iexp = new double[nrOfStates * nrOfStates];
        // Eigen vectors
        double[] Evec = eigenDecomposition.getEigenVectors();
        System.out.println("Evec:" + Arrays.toString(Evec));
        // inverse Eigen vectors
        double[] Ievc = eigenDecomposition.getInverseEigenVectors();
        System.out.println("Ivec:" + Arrays.toString(Ievc));
        // Eigen values
        double[] Eval = eigenDecomposition.getEigenValues();
        System.out.println("Eval:" + Arrays.toString(Eval));
        
        for (i = 0; i < nrOfStates; i++) {
            temp = Math.exp(distance * Eval[i]);
            for (j = 0; j < nrOfStates; j++) {
                iexp[i * nrOfStates + j] = Ievc[i * nrOfStates + j] * temp;
            }
        }
        System.out.println("iexp:" + Arrays.toString(iexp));
        
        int u = 0;
        for (i = 0; i < nrOfStates; i++) {
            for (j = 0; j < nrOfStates; j++) {
                temp = 0.0;
                for (k = 0; k < nrOfStates; k++) {
                    temp += Evec[i * nrOfStates + k] * iexp[k * nrOfStates + j];
                }

                matrix[u] = Math.abs(temp);
                u++;
            }
        }
        //double distance = 0.1;
        
        //double[] mat = new double[61 * 61];
        
        //yn98.getTransitionProbabilities(null, distance, 0, 1, mat);
        System.out.println("probabilities:" + Arrays.toString(matrix));
	}
	
	public void testYN98_fixedRateRealM()  throws Exception {
		double[][] rateMatrix = new double[][]{ 
			{-0.7960675534546201, 0.09620698815499484, 0.08536716759796173, 0.1256725430978752, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.07023835651703061, -1.0184303603758367, 0.036042648474508575, 0.2976559576826341, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.1663598488561541, 0.09620698815499484, -0.8770602347128125, 0.1256725430978752, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.07023835651703061, 0.2278666643415844, 0.036042648474508575, -0.948641067034787, 0.0, 0.0, 0.0, 0.09620698815499483, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.09620698815499483, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.07023835651703061, 0.0, 0.0, 0.0, -1.018430360375837, 0.09620698815499484, 0.08536716759796172, 0.1256725430978752, 0.036042648474508575, 0.0, 0.0, 0.0, 0.2976559576826342, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0702383565170306, 0.0, 0.0, 0.0702383565170306, -1.1151206241991782, 0.03604264847450857, 0.2976559576826341, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.29765595768263414, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0702383565170306, 0.0, 0.1663598488561541, 0.09620698815499484, -1.0994230416340292, 0.1256725430978752, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0702383565170306, 0.0702383565170306, 0.2278666643415844, 0.03604264847450857, -1.0453313308581287, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.1663598488561541, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, -0.8770602347128125, 0.09620698815499484, 0.08536716759796172, 0.12567254309787518, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0702383565170306, -1.0994230416340292, 0.03604264847450857, 0.29765595768263403, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.16635984885615407, 0.09620698815499484, -1.0837254590688798, 0.12567254309787518, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.09620698815499483, 0.0702383565170306, 0.22786666434158437, 0.03604264847450857, -1.0296337482929792, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0}, 
			{0.07023835651703061, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, -0.948641067034787, 0.09620698815499484, 0.08536716759796173, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499483, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0}, 
			{0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.07023835651703061, -1.0453313308581287, 0.036042648474508575, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0}, 
			{0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.1663598488561541, 0.09620698815499484, -1.0296337482929794, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0}, 
			{0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.03604264847450857, 0.07023835651703061, 0.2278666643415844, 0.036042648474508575, -0.9755420375170788, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752}, 
			{0.07023835651703061, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.7207744026932027, 0.09620698815499484, 0.08536716759796172, 0.1256725430978752, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, -1.1151206241991785, 0.03604264847450857, 0.2976559576826341, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.29765595768263414, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.09620698815499484, -0.8017670839513951, 0.1256725430978752, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.2278666643415844, 0.03604264847450857, -1.0453313308581287, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, -1.1151206241991782, 0.09620698815499484, 0.08536716759796172, 0.12567254309787518, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0702383565170306, -1.2118108880225198, 0.03604264847450857, 0.2976559576826341, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.1663598488561541, 0.09620698815499484, -1.1961133054573707, 0.12567254309787518, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0702383565170306, 0.2278666643415844, 0.03604264847450857, -1.1420215946814702, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, -0.8017670839513951, 0.09620698815499484, 0.08536716759796172, 0.1256725430978752, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0702383565170306, -1.1961133054573707, 0.03604264847450857, 0.2976559576826341, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.16635984885615407, 0.09620698815499484, -1.1804157228922214, 0.1256725430978752, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0702383565170306, 0.22786666434158437, 0.03604264847450857, -1.126324012116321, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, -1.0453313308581287, 0.09620698815499484, 0.08536716759796173, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.29765595768263403, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0702383565170306, -1.1420215946814702, 0.036042648474508575, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.1663598488561541, 0.09620698815499484, -1.126324012116321, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0702383565170306, 0.2278666643415844, 0.036042648474508575, -1.0722323013404205, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2976559576826341}, 
			{0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.8770602347128125, 0.09620698815499484, 0.08536716759796172, 0.12567254309787518, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, -1.0994230416340292, 0.03604264847450857, 0.29765595768263403, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.09620698815499484, -0.9580529159710047, 0.12567254309787518, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499483, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.22786666434158437, 0.03604264847450857, -1.0296337482929794, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.08536716759796172, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, -1.0994230416340292, 0.09620698815499484, 0.08536716759796172, 0.1256725430978752, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0702383565170306, -1.1961133054573707, 0.03604264847450857, 0.2976559576826341, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.16635984885615407, 0.09620698815499484, -1.1804157228922216, 0.1256725430978752, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0702383565170306, 0.22786666434158437, 0.03604264847450857, -1.126324012116321, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, -0.9580529159710047, 0.09620698815499484, 0.08536716759796172, 0.12567254309787518, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0702383565170306, -1.1804157228922214, 0.03604264847450857, 0.29765595768263403, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.16635984885615407, 0.09620698815499484, -1.1647181403270723, 0.12567254309787518, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615407, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0702383565170306, 0.2278666643415844, 0.03604264847450857, -1.1106264295511719, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499483, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, -1.0296337482929794, 0.09620698815499484, 0.08536716759796173, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0702383565170306, -1.126324012116321, 0.036042648474508575, 0.2976559576826341, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.1663598488561541, 0.09620698815499484, -1.1106264295511719, 0.12567254309787518, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12567254309787518, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615415, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0702383565170306, 0.2278666643415844, 0.036042648474508575, -1.0565347187752714, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1256725430978752}, 
			{0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.9390503258665894, 0.2976559576826341, 0.0, 0.09620698815499484, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.1256725430978752, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, -0.8692610325255395, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, 0.08536716759796173, 0.0, 0.0, 0.0, 0.1256725430978752}, 
			{0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.9390503258665894, 0.09620698815499484, 0.08536716759796173, 0.1256725430978752, 0.0, 0.0, 0.0, 0.29765595768263403, 0.0, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0702383565170306, -1.1420215946814702, 0.036042648474508575, 0.2976559576826341, 0.036042648474508575, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.09620698815499484, -1.0560856555992904, 0.1256725430978752, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.2976559576826341, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0702383565170306, 0.2278666643415844, 0.036042648474508575, -1.0722323013404205, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.2976559576826341}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1663598488561541, 0.0, 0.0, 0.09620698815499484, 0.0, 0.0, -1.0560856555992904, 0.036042648474508575, 0.2976559576826341, 0.0, 0.1256725430978752, 0.0, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09620698815499484, 0.0, 0.09620698815499484, -0.7779067318388636, 0.12567254309787518, 0.0, 0.0, 0.12567254309787518, 0.0}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.03604264847450857, 0.0, 0.0, 0.0, 0.0, 0.0, 0.16635984885615415, 0.0, 0.0, 0.0, 0.09620698815499484, 0.2278666643415844, 0.036042648474508575, -0.9862963622582407, 0.0, 0.0, 0.0, 0.1256725430978752}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.22786666434158437, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.8692610325255395, 0.09620698815499484, 0.08536716759796173, 0.1256725430978752}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0702383565170306, -1.0722323013404205, 0.036042648474508575, 0.2976559576826341}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0702383565170306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2278666643415844, 0.0, 0.0, 0.036042648474508575, 0.0, 0.1663598488561541, 0.09620698815499484, -0.9862963622582407, 0.1256725430978752}, 
			{0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07023835651703061, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.22786666434158442, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.036042648474508575, 0.0, 0.07023835651703061, 0.0, 0.0, 0.0, 0.22786666434158442, 0.0, 0.0, 0.036042648474508575, 0.0702383565170306, 0.22786666434158442, 0.036042648474508575, -1.0024430079993707}	
	};
        System.setOut(new PrintStream(new FileOutputStream("/home/kuangyu/Desktop/YN98_checkExp_directCal_03.txt")));
        System.out.println("rateM:" + Arrays.deepToString(rateMatrix));
        
        double[] matrix = new double[61 * 61];
        
        EigenSystem eigenSystem = createEigenSystem();
        EigenDecomposition eigenDecomposition = eigenSystem.decomposeMatrix(rateMatrix);
        
        double distance = 0.1;
        int nrOfStates = 61;
        int i, j, k;
        double temp;
        
        double[] iexp = new double[nrOfStates * nrOfStates];
        // Eigen vectors
        double[] Evec = eigenDecomposition.getEigenVectors();
        System.out.println("Evec:" + Arrays.toString(Evec));
        // inverse Eigen vectors
        double[] Ievc = eigenDecomposition.getInverseEigenVectors();
        System.out.println("Ivec:" + Arrays.toString(Ievc));
        // Eigen values
        double[] Eval = eigenDecomposition.getEigenValues();
        System.out.println("Eval:" + Arrays.toString(Eval));
        
        for (i = 0; i < nrOfStates; i++) {
            temp = Math.exp(distance * Eval[i]);
            for (j = 0; j < nrOfStates; j++) {
                iexp[i * nrOfStates + j] = Ievc[i * nrOfStates + j] * temp;
            }
        }
        System.out.println("iexp:" + Arrays.toString(iexp));
        
        int u = 0;
        for (i = 0; i < nrOfStates; i++) {
            for (j = 0; j < nrOfStates; j++) {
                temp = 0.0;
                for (k = 0; k < nrOfStates; k++) {
                    temp += Evec[i * nrOfStates + k] * iexp[k * nrOfStates + j];
                }

                matrix[u] = Math.abs(temp);
                u++;
            }
        }
        //double distance = 0.1;
        
        //double[] mat = new double[61 * 61];
        
        //yn98.getTransitionProbabilities(null, distance, 0, 1, mat);
        System.out.println("probabilities:" + Arrays.toString(matrix));	
	}
}
